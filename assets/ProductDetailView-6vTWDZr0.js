import{S as Ct,A as yt}from"./autoplay-CcLt2_l8.js";import{k as Z,l as It,m as j,p as At,q as Nt,v as wt,f as St,h as R,i as X,x as xt,g as z,c as A,a as e,y as Lt,d as U,w as q,r as Ot,b as Dt,F as W,j as Q,t as v,e as k,o as N}from"./index-8esUYsfs.js";import{a as Rt,c as kt}from"./products-ChNhoPpm.js";import{u as Vt}from"./cartStore-Bq9wxhJJ.js";var V={exports:{}},P={exports:{}};var Pt=P.exports,H;function $t(){return H||(H=1,(function(x,b){(function(u,c){x.exports=c(Z(),It(),j())})(Pt,(function(u,c,T){const o="swipe",l=".bs.swipe",C=`touchstart${l}`,w=`touchmove${l}`,L=`touchend${l}`,d=`pointerdown${l}`,m=`pointerup${l}`,S="touch",_="pen",n="pointer-event",h=40,r={endCallback:null,leftCallback:null,rightCallback:null},f={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class E extends c{constructor(s,y){super(),this._element=s,!(!s||!E.isSupported())&&(this._config=this._getConfig(y),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return r}static get DefaultType(){return f}static get NAME(){return o}dispose(){u.off(this._element,l)}_start(s){if(!this._supportPointerEvents){this._deltaX=s.touches[0].clientX;return}this._eventIsPointerPenTouch(s)&&(this._deltaX=s.clientX)}_end(s){this._eventIsPointerPenTouch(s)&&(this._deltaX=s.clientX-this._deltaX),this._handleSwipe(),T.execute(this._config.endCallback)}_move(s){this._deltaX=s.touches&&s.touches.length>1?0:s.touches[0].clientX-this._deltaX}_handleSwipe(){const s=Math.abs(this._deltaX);if(s<=h)return;const y=s/this._deltaX;this._deltaX=0,y&&T.execute(y>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(u.on(this._element,d,s=>this._start(s)),u.on(this._element,m,s=>this._end(s)),this._element.classList.add(n)):(u.on(this._element,C,s=>this._start(s)),u.on(this._element,w,s=>this._move(s)),u.on(this._element,L,s=>this._end(s)))}_eventIsPointerPenTouch(s){return this._supportPointerEvents&&(s.pointerType===_||s.pointerType===S)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}return E}))})(P)),P.exports}var Mt=V.exports,J;function Xt(){return J||(J=1,(function(x,b){(function(u,c){x.exports=c(At(),Z(),Nt(),wt(),j(),$t())})(Mt,(function(u,c,T,o,l,C){const w="carousel",d=".bs.carousel",m=".data-api",S="ArrowLeft",_="ArrowRight",n=500,h="next",r="prev",f="left",E="right",tt=`slide${d}`,s=`slid${d}`,y=`keydown${d}`,et=`mouseenter${d}`,st=`mouseleave${d}`,it=`dragstart${d}`,nt=`load${d}${m}`,ot=`click${d}${m}`,B="carousel",O="active",rt="slide",at="carousel-item-end",lt="carousel-item-start",ct="carousel-item-next",ut="carousel-item-prev",Y=".active",K=".carousel-item",dt=Y+K,_t=".carousel-item img",ht=".carousel-indicators",pt="[data-bs-slide], [data-bs-slide-to]",mt='[data-bs-ride="carousel"]',ft={[S]:E,[_]:f},Et={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},vt={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class I extends u{constructor(t,i){super(t,i),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=o.findOne(ht,this._element),this._addEventListeners(),this._config.ride===B&&this.cycle()}static get Default(){return Et}static get DefaultType(){return vt}static get NAME(){return w}next(){this._slide(h)}nextWhenVisible(){!document.hidden&&l.isVisible(this._element)&&this.next()}prev(){this._slide(r)}pause(){this._isSliding&&l.triggerTransitionEnd(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){c.one(this._element,s,()=>this.cycle());return}this.cycle()}}to(t){const i=this._getItems();if(t>i.length-1||t<0)return;if(this._isSliding){c.one(this._element,s,()=>this.to(t));return}const a=this._getItemIndex(this._getActive());if(a===t)return;const g=t>a?h:r;this._slide(g,i[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&c.on(this._element,y,t=>this._keydown(t)),this._config.pause==="hover"&&(c.on(this._element,et,()=>this.pause()),c.on(this._element,st,()=>this._maybeEnableCycle())),this._config.touch&&C.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const a of o.find(_t,this._element))c.on(a,it,g=>g.preventDefault());const i={leftCallback:()=>this._slide(this._directionToOrder(f)),rightCallback:()=>this._slide(this._directionToOrder(E)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),n+this._config.interval))}};this._swipeHelper=new C(this._element,i)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const i=ft[t.key];i&&(t.preventDefault(),this._slide(this._directionToOrder(i)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const i=o.findOne(Y,this._indicatorsElement);i.classList.remove(O),i.removeAttribute("aria-current");const a=o.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);a&&(a.classList.add(O),a.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const i=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=i||this._config.defaultInterval}_slide(t,i=null){if(this._isSliding)return;const a=this._getActive(),g=t===h,p=i||l.getNextActiveElement(this._getItems(),a,g,this._config.wrap);if(p===a)return;const G=this._getItemIndex(p),F=gt=>c.trigger(this._element,gt,{relatedTarget:p,direction:this._orderToDirection(t),from:this._getItemIndex(a),to:G});if(F(tt).defaultPrevented||!a||!p)return;const bt=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(G),this._activeElement=p;const D=g?lt:at,M=g?ct:ut;p.classList.add(M),l.reflow(p),a.classList.add(D),p.classList.add(D);const Tt=()=>{p.classList.remove(D,M),p.classList.add(O),a.classList.remove(O,M,D),this._isSliding=!1,F(s)};this._queueCallback(Tt,a,this._isAnimated()),bt&&this.cycle()}_isAnimated(){return this._element.classList.contains(rt)}_getActive(){return o.findOne(dt,this._element)}_getItems(){return o.find(K,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return l.isRTL()?t===f?r:h:t===f?h:r}_orderToDirection(t){return l.isRTL()?t===r?f:E:t===r?E:f}static jQueryInterface(t){return this.each(function(){const i=I.getOrCreateInstance(this,t);if(typeof t=="number"){i.to(t);return}if(typeof t=="string"){if(i[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);i[t]()}})}}return c.on(document,ot,pt,function($){const t=o.getElementFromSelector(this);if(!t||!t.classList.contains(B))return;$.preventDefault();const i=I.getOrCreateInstance(t),a=this.getAttribute("data-bs-slide-to");if(a){i.to(a),i._maybeEnableCycle();return}if(T.getDataAttribute(this,"slide")==="next"){i.next(),i._maybeEnableCycle();return}i.prev(),i._maybeEnableCycle()}),c.on(window,nt,()=>{const $=o.find(mt);for(const t of $)I.getOrCreateInstance(t)}),l.defineJQueryPlugin(I),I}))})(V)),V.exports}Xt();const Ut={class:"container"},qt={class:"row align-items-center"},Wt={class:"col-md-7"},Bt={"aria-label":"breadcrumb"},Yt={class:"breadcrumb bg-white px-0 mb-0 py-3"},Kt={class:"breadcrumb-item"},Gt={class:"breadcrumb-item"},Ft={id:"carouselExample",class:"carousel slide"},zt={class:"carousel-container carousel-inner"},Qt={class:"carousel-item active"},Ht=["src"],Jt=["src"],Zt={class:"col-md-5"},jt={class:"fw-bold h1 mb-1"},te={class:"mb-0 text-muted text-end"},ee={class:"h4 fw-bold text-end"},se={class:"row align-items-center"},ie={class:"col-6"},ne={class:"input-group my-3 bg-light rounded"},oe={class:"input-group-prepend"},re=["disabled"],ae=["value"],le={class:"input-group-append"},ce={class:"row my-5"},ue={class:"col-md-4"},de={class:"col-md-3"},_e={style:{"white-space":"pre-wrap"},class:"text-muted"},he={class:"swiper-wrapper"},pe={class:"card border-0 mb-4 position-relative position-relative"},me=["src","alt"],fe={class:"card-body p-0"},Ee={class:"mb-0 mt-3"},ve={class:"card-text mb-0"},be={class:"text-muted"},Ae=St({__name:"ProductDetailView",setup(x){const b=R(1),u=xt(),c=Vt(),T=X(()=>u.params.id),o=R({category:"",content:"",description:"",id:"",imageUrl:"",imagesUrl:[],is_enabled:0,num:0,origin_price:0,price:0,title:"",unit:""}),l=R([]),C=async()=>{try{const _=await kt(T.value);o.value=_.data.product}catch{alert("取得產品資訊失敗")}};z(()=>{C(),L()});const w=X(()=>o.value?o.value.category:""),L=async()=>{try{const _=await Rt({category:w.value});l.value=_.data.products}catch{alert("取得產品列表失敗")}},d=X(()=>l.value?l.value.filter(_=>_.id!==u.params.id):[]),m=R(null);z(()=>{m.value&&new Ct(m.value,{modules:[yt],loop:!0,autoplay:{delay:2500,disableOnInteraction:!1},slidesPerView:2,spaceBetween:10,breakpoints:{767:{slidesPerView:3,spaceBetween:30}}})});const S=async()=>{c.addCartItem({product_id:T.value,qty:b.value})};return(_,n)=>{const h=Ot("RouterLink");return N(),A("div",Ut,[e("div",qt,[e("div",Wt,[e("nav",Bt,[e("ol",Yt,[e("li",Kt,[U(h,{class:"text-muted",to:"/"},{default:q(()=>[...n[2]||(n[2]=[k("首頁",-1)])]),_:1})]),e("li",Gt,[U(h,{class:"text-muted",to:"/products"},{default:q(()=>[...n[3]||(n[3]=[k("產品列表",-1)])]),_:1})]),n[4]||(n[4]=e("li",{class:"breadcrumb-item active","aria-current":"page"},"產品詳細",-1))])]),e("div",Ft,[e("div",zt,[e("div",Qt,[e("img",{src:o.value?.imageUrl,class:"d-block w-100",alt:"主圖"},null,8,Ht)]),(N(!0),A(W,null,Q(o.value?.imagesUrl.filter(Boolean),r=>(N(),A("div",{key:r,class:"carousel-item"},[e("img",{src:r,class:"d-block w-100",alt:"副圖"},null,8,Jt)]))),128))]),n[5]||(n[5]=Dt('<button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="visually-hidden">Previous</span></button><button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="visually-hidden">Next</span></button>',2))])]),e("div",Zt,[e("h2",jt,v(o.value?.title),1),e("p",te,[e("del",null,"NT$"+v(o.value?.origin_price?.toLocaleString("zh-TW")),1)]),e("p",ee,"NT$"+v(o.value?.price?.toLocaleString("zh-TW")),1),e("div",se,[e("div",ie,[e("div",ne,[e("div",oe,[e("button",{onClick:n[0]||(n[0]=r=>b.value--),disabled:b.value<=1,class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1"},[...n[6]||(n[6]=[e("i",{class:"fas fa-minus"},null,-1)])],8,re)]),e("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none bg-light",readonly:"",value:b.value},null,8,ae),e("div",le,[e("button",{onClick:n[1]||(n[1]=r=>b.value++),class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2"},[...n[7]||(n[7]=[e("i",{class:"fas fa-plus"},null,-1)])])])])]),e("div",{class:"col-6"},[e("button",{onClick:S,type:"button",class:"text-nowrap btn btn-dark w-100 py-2"}," 加入購物車 ")])])])]),e("div",ce,[e("div",ue,[e("p",null,v(o.value?.description),1)]),e("div",de,[e("p",_e,v(o.value?.content),1)])]),d.value.length?(N(),A(W,{key:0},[n[9]||(n[9]=e("h3",{class:"fw-bold"},"你可能會喜歡的植栽",-1)),e("div",{ref_key:"swiperContainer",ref:m,class:"swiper mt-4 mb-5"},[e("div",he,[(N(!0),A(W,null,Q(d.value,r=>(N(),A("div",{key:r.id,class:"swiper-slide"},[e("div",pe,[e("img",{src:r.imageUrl,class:"card-img-top object-fit-cover rounded-0",style:{height:"280px"},alt:r.title},null,8,me),e("div",fe,[e("h4",Ee,[U(h,{to:`/products/${r.id}`},{default:q(()=>[k(v(r.title),1)]),_:2},1032,["to"])]),e("p",ve,[k(" NT$"+v(r.price.toLocaleString("zh-TW"))+" ",1),e("span",be,[e("del",null,"NT$"+v(r.origin_price.toLocaleString("zh-TW")),1)])]),n[8]||(n[8]=e("p",{class:"text-muted mt-3"},null,-1))])])]))),128))])],512)],64)):Lt("",!0)])}}});export{Ae as default};
